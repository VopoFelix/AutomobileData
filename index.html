<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Automobile-Data</title>
<style>
    body { font-family: Arial, sans-serif; margin:0; background-color:#f0f0f5; }
    header { background-color:#333; color:white; padding:20px; text-align:center; }
    .search-bar { background-color:white; padding:20px; display:flex; justify-content:center; gap:10px; flex-wrap:wrap; margin-top:10px; }
    input, button { padding:6px; }
    .brands-grid { display:grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap:20px; margin:30px; }
    .brand { background-color:white; padding:20px; text-align:center; border-radius:8px; cursor:pointer; box-shadow:0 0 5px rgba(0,0,0,0.1); }
    .brand:hover { background-color:#e0e0ff; }
</style>
</head>
<body>
<header>
    <h1>Automobile-Data</h1>
</header>

<div class="search-bar">
    <input id="marke" placeholder="Marke">
    <input id="modell" placeholder="Modell">
    <input id="baujahr" placeholder="Baujahr">
    <input id="kraftstoff" placeholder="Kraftstoffart">
    <button id="searchBtn">Suchen</button>
</div>

<div class="brands-grid" id="brandsGrid"></div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    let autos = [];

    const markeInput = document.getElementById('marke');
    const modellInput = document.getElementById('modell');
    const baujahrInput = document.getElementById('baujahr');
    const kraftstoffInput = document.getElementById('kraftstoff');

    const brandsGrid = document.getElementById('brandsGrid');
    const searchBtn = document.getElementById('searchBtn');

    fetch('autos.json')
        .then(response => response.json())
        .then(data => {
            autos = data;
            populateBrandsGrid();
        })
        .catch(err => console.error("Fehler beim Laden von autos.json:", err));

    function updateDependentFields() {
        const selectedMarke = markeInput.value.toLowerCase();
        const filteredAutos = selectedMarke ? autos.filter(a => a.marke.toLowerCase().includes(selectedMarke)) : autos;

        // Modell
        const modelle = Array.from(new Set(filteredAutos.map(a => a.modell))).sort();
        modellInput.placeholder = modelle.length ? `z.B. ${modelle[0]}` : "Modell";

        // Baujahr
        const baujahre = Array.from(new Set(filteredAutos.map(a => a.baujahr))).sort((a,b)=>a-b);
        baujahrInput.placeholder = baujahre.length ? `z.B. ${baujahre[0]}` : "Baujahr";

        // Kraftstoff
        const kraftstoffe = Array.from(new Set(filteredAutos.map(a => a.kraftstoff).filter(k=>k))).sort();
        kraftstoffInput.placeholder = kraftstoffe.length ? `z.B. ${kraftstoffe[0]}` : "Kraftstoffart";
    }

    markeInput.addEventListener('input', updateDependentFields);

    function populateBrandsGrid() {
        const brands = Array.from(new Set(autos.map(a => a.marke))).sort();
        brands.forEach(brand => {
            const div = document.createElement('div');
            div.className = 'brand';
            div.textContent = brand;
            div.onclick = () => {
                markeInput.value = brand;
                updateDependentFields();
                searchBtn.click();
            };
            brandsGrid.appendChild(div);
        });
    }

    searchBtn.addEventListener('click', () => {
        const params = new URLSearchParams({
            marke: markeInput.value,
            modell: modellInput.value,
            baujahr: baujahrInput.value,
            kraftstoff: kraftstoffInput.value
        });
        window.location.href = 'results.html?' + params.toString();
    });
});
</script>
</body>
</html>
